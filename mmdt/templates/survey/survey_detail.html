{% extends "base.html" %}
{% load static %}
{% block content %}
  <h1>{{ survey.title }}</h1>
  {% if messages %}
    <ul class="messages">
      {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  <form method="post">
    {% csrf_token %}
    {% for question in current_page_questions %}
      <div class="questions">
        <h4>{{ question.question_text }}</h4>
        {% if question.question_type == question.MULTIPLE_CHOICE %}
          {% for choice in question.choices.all %}
            <input type="radio" name="question_{{ question.id }}" id="choice{{ choice.id }}" value="{{ choice.id }}">
            <label for="choice{{ choice.id }}">{{ choice.choice_text }}</label><br>
          {% endfor %}
        {% elif question.question_type == question.CHECKBOX %}
          {% for choice in question.choices.all %}
            <input type="checkbox" name="question_{{ question.id }}" id="choice{{ choice.id }}" value="{{ choice.id }}">
            <label for="choice{{ choice.id }}">{{ choice.choice_text }}</label><br>
          {% endfor %}
        {% elif question.question_type == question.TEXT %}
          <input type="text" name="question_{{ question.id }}" id="text_question{{ question.id }}">
        {% elif question.question_type == question.LONG_TEXT %}
          <textarea name="question_{{ question.id }}" id="long_text_question{{ question.id }}"></textarea>
        {% elif question.question_type == question.DROPDOWN %}
            <select name="question_{{ question.id }}">
                {% for choice in question.choices.all %}
                    <option value="{{ choice.id }}">{{ choice.choice_text }}</option>
                {% endfor %}
            </select>
            {% elif question.question_type == question.SLIDING_SCALE %}
              <input type="range" name="question_{{ question.id }}" id="slider{{ question.id }}" min="0" max="{{ question.choices.count|add:"-1" }}" value="0" step="1">
              <output for="slider{{ question.id }}" id="output{{ question.id }}">Slide your choice</output>
              <div id="colorChoices{{ question.id }}">
                {% for choice in question.choices.all %}
                    <span data-choice-text="{{ choice.choice_text }}">{{ choice.choice_text }}</span>
                {% endfor %}
            </div>
            <script src="{% static 'assets/js/slide.js' %}"></script>
          {% endif %}

      </div>
    {% endfor %}
    <!-- Display pagination links for questions -->
    {% if current_page_questions %}
        <div class="pagination">
            <span class="step-links">
                {% if current_page_questions.has_previous %}
                    <button type="button" class="button" onclick="window.location='?page={{ current_page_questions.previous_page_number }}'">&laquo; Previous</button>
                {% else %}
                    <button type="button" class="button disabled" aria-disabled="true">Previous</button>
                {% endif %}

                {% for i in current_page_questions.paginator.page_range %}
                    {% if i == current_page_questions.number %}
                        <button type="button" class="button btn-custom">{{ i }}</button>
                    {% else %}
                        <button type="button" class="button" onclick="window.location='?page={{ i }}'">{{ i }}</button>
                    {% endif %}
                {% endfor %}

                {% if current_page_questions.has_next %}
                    <button type="button" class="button" onclick="window.location='?page={{ current_page_questions.next_page_number }}'">Next &raquo;</button>
                {% else %}
                    <button type="button" class="button disabled" aria-disabled="true">Next</button>
                {% endif %}
            </span>
        </div>
    {% endif %}
    {% if current_page_questions and not current_page_questions.has_next %}
    <button type="submit" class="button btn-submit">Submit</button>
  {% endif %}
  </form>
{% endblock %}
